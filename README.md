# DAVI Monorepo

### Prerequisites

1. `pnpm` v7.18.2(`npm` and `yarn` are **not supported**.)
https://pnpm.io/installation

### How to setup

1. Clone this repo.
2. Clone dxdao-contracts into apps/dxdao-contracts `git clone -b feature/monorepo-setup-w-create2 https://github.com/DXgovernance/dxdao-contracts apps/dxdao-contracts`
3. Install dependencies `pnpm i`

### Common Issues and Solutions

1. `pnpm i` fails with `node-gyp` errors

You might not have the relavant build tools for node-gyp to run. Check this if you're on [Mac OS](https://github.com/nodejs/node-gyp/blob/HEAD/macOS_Catalina.md#The-acid-test).

### Develop

To run project locally you need to compile contracts, run hardhat node from dev-scripts, run subgraph docker, create/deploy local subgraph and run davi-frontend. To do this you can do it in separate terminals or run `pnpm dev` from root project. See `turbo.json` for turbo config

#### Issues:

- Both davi-frontend and subgraph are using bytecodes generated by dxdao-contracts when `compile` comand is executed. We need a way to share these bytecodes to use them from different apps. Creating a /package for this might be a good solution
- Same thing as bytecodes, we are copy-pasting abis generated by dxdao-contracts into davi and subgraph apps. We need to automate this.
- Considering that any changes to the contracts will generate new addresses, once that runs, we need to get the addresses of the contracts deployed on the local network and update the davi (beforeBuild script) and subgraph (netwoks.json) configurations that uses those addresses.
